<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Security Audit for Awesome Web Site Jet Hughes - 9474308
Summary of system Function This system is a simple website for a store called Things & Co."><title>ass01-security-audit</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://jethughes.github.io/notes//icon.png><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Source+Sans+Pro:wght@400;600;700&family=Fira+Code:wght@400;700&display=swap" rel=stylesheet><link href=https://jethughes.github.io/notes/styles.1a1ffb6f8cc2d9990f06b61d70c9b09b.min.css rel=stylesheet><script src=https://jethughes.github.io/notes/js/darkmode.46b07878b7f5d9e26ad7a3c40f8a0605.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://jethughes.github.io/notes/js/popover.688c5dcb89a57776d7f1cbeaf6f7c44b.min.js></script>
<script>const BASE_URL="https://jethughes.github.io/notes/",fetchData=Promise.all([fetch("https://jethughes.github.io/notes/indices/linkIndex.c6a47043584f80c8d94143e4011b7860.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://jethughes.github.io/notes/indices/contentIndex.1bfb97aeb71c9ea18bbb62f0ff02f9a7.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const n=new URL("https://jethughes.github.io/notes/"),s=n.pathname,o=window.location.pathname,i=s==o,e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=i&&!1;drawGraph("https://jethughes.github.io/notes",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2}),initPopover("https://jethughes.github.io/notes",!0,!0)},init=(e=document)=>{renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/jethughes.github.io\/notes\/js\/router.557a499829be51f9008c6efa5b73602a.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://jethughes.github.io/notes/js/search.cf33b507388f3dfd5513a2afcda7af41.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://jethughes.github.io/notes/>Jet's Notes</a></h1><svg tabindex="0" id="search-icon" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg><div class=spacer></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>ass01-security-audit</h1><p class=meta>Last updated September 9, 2022</p><ul class=tags><li><a href=https://jethughes.github.io/notes/tags/assignment/>Assignment</a></li><li><a href=https://jethughes.github.io/notes/tags/comp210/>Comp210</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#summary-of-system>Summary of system</a><ol><li><a href=#function>Function</a></li><li><a href=#technology>Technology</a></li></ol></li><li><a href=#flaws>Flaws</a><ol><li><a href=#sql-injection>SQL Injection</a></li><li><a href=#cross-site-scriptingjavascript-injection>Cross site scripting/JavaScript injection</a></li><li><a href=#password-policy>Password policy</a></li><li><a href=#use-of-a-broken-or-risky-cryptographic-algorithm>Use of a Broken or Risky Cryptographic Algorithm</a></li><li><a href=#improper-restriction-of-excessive-authentication-attempts>Improper Restriction of Excessive Authentication Attempts</a></li><li><a href=#path-traversal>Path traversal</a></li><li><a href=#cleartext-transmission-of-sensitive-information>Cleartext Transmission of Sensitive Information</a></li></ol></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></details></aside><a href=#security-audit-for-awesome-web-site><h1 id=security-audit-for-awesome-web-site><span class=hanchor arialabel=Anchor># </span>Security Audit for Awesome Web Site</h1></a><p>Jet Hughes - 9474308</p><a href=#summary-of-system><h2 id=summary-of-system><span class=hanchor arialabel=Anchor># </span>Summary of system</h2></a><a href=#function><h3 id=function><span class=hanchor arialabel=Anchor># </span>Function</h3></a><p>This system is a simple website for a store called Things & Co. It allows users to create an account, login, and view their products. There are four pages: Home, Create Account, View Catalogue, and Log In. The home page is a simple landing page with a brief description of the website and some images. The View Catalogue page shows information about the list of products the store sells. It also allows the user to search for products.</p><p>To create an account the user must provide a Username, Real name, email, address, credit card information and a password. They are then able to log in to their account using the Login page.</p><a href=#technology><h3 id=technology><span class=hanchor arialabel=Anchor># </span>Technology</h3></a><p>It is a Web application running on a local virtual machine using Java Servlets and JSPs in the Tomcat Web server. It also uses an H2 database for storage of user, and product data.</p><a href=#flaws><h2 id=flaws><span class=hanchor arialabel=Anchor># </span>Flaws</h2></a><a href=#sql-injection><h3 id=sql-injection><span class=hanchor arialabel=Anchor># </span>SQL Injection</h3></a><p>CWE: 89</p><p>It is possible to inject SQL into the database using the login username field, and display it in the browser as the &ldquo;username&rdquo; of the logged-in user.</p><p>The first thing I attempted was to log in using the username " &lsquo;or 1=1;&ndash;". This worked and I was logged in as administrator.
After that, I created an account. When I noticed that my username was displayed in the browser I attempted to extract data from the database and display is as this username.</p><p>In the username field of the login form, I entered the string:</p><p>&rsquo; union select group_concat(username||&rsquo;:&rsquo;||password||&rsquo;:&rsquo;||name||&rsquo;:&rsquo;||credit_card_number||&rsquo;:&rsquo;||credit_card_expiry||&rsquo;:&rsquo;||credit_card_cvv) from user as name;&ndash;</p><p>&rsquo; union (select TABLE_NAME, TABLE_SCHEMA, 1, 2 FROM information_schema.tables) ;&ndash;</p><p>This resulted in all the user&rsquo;s data, credit card information, and hashed passwords being displayed in the browser. I was then able to crack 48 of the passwords using Hashcat and the rock you word list.</p><p>An attacker would not know the names of the fields or the tables. However, security through obscurity is not sufficient and an attacker could guess or otherwise find the information.</p><a href=#cross-site-scriptingjavascript-injection><h3 id=cross-site-scriptingjavascript-injection><span class=hanchor arialabel=Anchor># </span>Cross site scripting/JavaScript injection</h3></a><p>CWE: 79</p><p>The product catalogue is visible to other users. This means if we were able to update the product information in the database, we could run JavaScript on the browser of other users.</p><p>Since we are able to inject SQL using the username field on the login page, we can execute an UPDATE command on the database. This is the input I used:</p><p>&lsquo;; update PRODUCT set DESCRIPTION = &lsquo;alert(&ldquo;hello&rdquo;)&rsquo; where PRODUCT_ID = 67696;&ndash;</p><p>An attacker could use this to present the user with an unsafe link, or export data such as session ID&rsquo;s and cookie data to a remote server where they can view it.</p><p>I was also able to create an account with the username &lsquo;&rsquo;alert(&ldquo;hello&rdquo;)", however when I logged in, the alert was not shown and the username in the login page was blank.</p><a href=#password-policy><h3 id=password-policy><span class=hanchor arialabel=Anchor># </span>Password policy</h3></a><p>CWE: 521</p><p>This website only requires that the user&rsquo;s passwords have 5 character and 1 number. Upper-case letters and numbers are not required. This results in a character set size of 36, and a Shannon Entropy of 15 bits.</p><p>This does not result in a secure password, and means the passwords can be easily cracked. It is also likely that many of the passwords will be simply 5 letters, then a number. This makes it very easy to crack these passwords using a pattern technique.</p><a href=#use-of-a-broken-or-risky-cryptographic-algorithm><h3 id=use-of-a-broken-or-risky-cryptographic-algorithm><span class=hanchor arialabel=Anchor># </span>Use of a Broken or Risky Cryptographic Algorithm</h3></a><p>CWE: 327</p><p>The website uses md5 to hash the passwords, which is not a secure hash function. Furthermore, the passwords are not salted or peppered.</p><p>I was able to crack 48 of the 100 passwords using Hashcat and the rockyou word list with the command: hashcat.exe -m 0 -a 0 pwds.txt rockyou.txt.</p><a href=#improper-restriction-of-excessive-authentication-attempts><h3 id=improper-restriction-of-excessive-authentication-attempts><span class=hanchor arialabel=Anchor># </span>Improper Restriction of Excessive Authentication Attempts</h3></a><p>CWE: 307</p><p>The login page does not restrict the number of login attempts. This means it is possible for an attacker to attempt many passwords to gain access to an account.</p><a href=#path-traversal><h3 id=path-traversal><span class=hanchor arialabel=Anchor># </span>Path traversal</h3></a><p>CWE: 22</p><ul><li>You can access the welcome page simply using the path /catalogue/welcome.jsp. This will load the welcome page with the username null. However, it is unclear whether this is a security issue as currently the welcome page offers no functionality.</li><li>I don&rsquo;t think there are any path traversal flaws in this website. This is because there isn&rsquo;t any URLs which contain queries or parameters relating to sensitive pages.</li></ul><a href=#cleartext-transmission-of-sensitive-information><h3 id=cleartext-transmission-of-sensitive-information><span class=hanchor arialabel=Anchor># </span>Cleartext Transmission of Sensitive Information</h3></a><p>CWE: 319</p><p>When a user logs in, their username and unhashed password are transmitted in a cleartext post request to the server. This information is susceptible to a man in the middle attack and other methods of interception.</p><a href=#example-payload><h4 id=example-payload><span class=hanchor arialabel=Anchor># </span>Example payload:</h4></a><p><img src=https://i.imgur.com/9Tn6gx1.png alt="example payload"></p><a href=#conclusion><h2 id=conclusion><span class=hanchor arialabel=Anchor># </span>Conclusion</h2></a><p>This system is not secure. I was able to identify multiple vulnerabilities, and successfully carry out attacks to exploit these vulnerabilities.</p><p>The most severe of these was a simple SQL Injection attack. I was able to extract the credit card information of all the users, and crack the passwords of nearly 50% of the accounts. This is a major security issue.</p><p>I was also able to inject JavaScript code into the database, which would then be run on the browser of other users.</p><p>Furthermore, the system does not have adequate password policy and allows users to choose weak passwords. It also allows excessive authentication attempts.</p></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/notes/notes/comp-210/ data-ctx="assignment 1" data-src=/notes/comp-210 class=internal-link>comp-210</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://jethughes.github.io/notes/js/graph.afdb02e537635f9a611b53a988e5645b.js></script></div></div><div id=contact_buttons><footer><p>Made with <a href=https://obsidian.md>Obsidian</a> using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, 2022</p><ul><li><a href=/notes/>Home</a></li><li><a href=https://github.com/jethughes>Github</a></li><li><a href=https://www.linkedin.com/in/jet-hughes-b3b688237>LinkedIn</a></li></ul></footer></div></div></body></html>